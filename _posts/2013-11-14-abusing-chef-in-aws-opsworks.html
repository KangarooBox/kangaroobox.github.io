---
layout: post
title: "(Ab)using Chef in AWS OpsWorks."
date: '2013-11-14T14:23:00.003-05:00'
author: Richard Hurt
tags:
modified_time: '2014-07-21T09:14:17.567-04:00'
thumbnail: http://3.bp.blogspot.com/-_dBZpNdgRr4/UoUijsDPC_I/AAAAAAAAQ5k/MzPq2hjsBy8/s72-c/opsworks-custom-chef.tiff
blogger_id: tag:blogger.com,1999:blog-5693054744995313095.post-1471438396171289367
blogger_orig_url: http://kangaroobox.blogspot.com/2013/11/abusing-chef-in-aws-opsworks.html
---

<h2><a href="http://aws.amazon.com/opsworks/" target="_blank">AWS OpsWorks</a></h2><div>AWS OpsWorks is a wonderful tool that I'm growing more and more fond of every day. &nbsp;However, not being familiar with <a href="http://www.opscode.com/chef/" target="_blank">Chef</a> I've been hamstrung by what I can do with it. &nbsp;I wanted to be able to create a clean, simple layer but still retain the ability to deploy code automatically to it. &nbsp;The "other" layer type was perfect, except it didn't include any deployment tools (or other goodies). &nbsp;So, banging my head against the wall for a couple of days I have some tips to share.</div><h3><br /></h3><h3>Tip #1 - Chef-Solo is globally scoped</h3><div>OpsWorks uses Chef-Solo which is globally scoped. &nbsp;This means that there is no Chef server and you don't have to do any funky namespace things in your custom Chef recipes. &nbsp;I was trying to copy the OpsWorks Chef recipes into my custom cookbooks, and trying to use Git submodules, and all kinds of funky stuff. &nbsp;The simple answer is that you don't have to do any of that; just use it like its in your custom cookbook and it will work.</div><div><br /><script src="https://gist.github.com/rnhurt/4cf1fbb2b7388685fc16.js"></script><br /><h3>Tip #2 - Drop the manafests</h3></div><div>Just a small tip here, Chef-Solo doesn't use the <code>metadata.rb</code> file so there is no need to include it in your cookbook.  Unless you really want to, that is.</div><h3><br /></h3><h3>Tip #3 - Just do it!</h3><div>You don't have to create your own custom cookbook if you don't want to. &nbsp;If you find something in the <a href="https://github.com/aws/opsworks-cookbooks" target="_blank">opsworks-cookbooks</a> that you want to use, say <code>opsworks_bundler</code>, then just include it in the Custom Chef Recipes section of the layer edit page:</div><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-_dBZpNdgRr4/UoUijsDPC_I/AAAAAAAAQ5k/MzPq2hjsBy8/s1600/opsworks-custom-chef.tiff" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img alt="OpsWorks option screenshot" border="0" src="http://3.bp.blogspot.com/-_dBZpNdgRr4/UoUijsDPC_I/AAAAAAAAQ5k/MzPq2hjsBy8/s1600/opsworks-custom-chef.tiff" title="OpsWorks options" /></a></div><div><h2>Wrapup</h2></div><div>As with most of my blog posts, this one is written with future me in mind. &nbsp;If I don't write it down, I'll forget it. &nbsp;However, it will hopefully help someone else that is in my position of only knowing enough Chef to be dangerous. &nbsp;I really shouldn't have had to bang my head against this for so long. &nbsp;:/</div><div><br /></div>